@startuml
skinparam backgroundcolor #F8F9FA
skinparam classBackgroundColor #FFFFFF
skinparam classBorderColor #333333
skinparam classArrowColor #2E86AB

' === Основные бизнес-сущности ===

entity "Клиенты" as customers #FFE5D9 {
  + customer_id: Integer <<PK>>
  --
  full_name: String
  phone_number: String
  email_address: String
  registration_date: DateTime
}

entity "Автомобили" as cars #FFD7BA {
  + vehicle_id: Integer <<PK>>
  --
  model: String
  license_plate: String
  # owner_id: Integer <<FK>>
}

entity "Автомойки" as car_washes #FFB4A2 {
  + wash_id: Integer <<PK>>
  --
  name: String
  address: String
  contact_phone: String
  # city_id: Integer <<FK>>
  # district_id: Integer <<FK>>
}

entity "Заказы" as orders #E5989B {
  + order_id: Integer <<PK>>
  --
  order_datetime: DateTime
  status: String
  total_amount: Decimal
  # customer_id: Integer <<FK>>
  # vehicle_id: Integer <<FK>>
  # wash_id: Integer <<FK>>
  # employee_id: Integer <<FK>>
  # box_id: Integer <<FK>>
}

' === Справочники и классификаторы ===

entity "Города" as cities #B5EAD7 {
  + city_id: Integer <<PK>>
  --
  city_name: String
  region: String
}

entity "Районы" as districts #C7CEEA {
  + district_id: Integer <<PK>>
  --
  district_name: String
  # city_id: Integer <<FK>>
}

' === Операционные сущности ===

entity "Сотрудники" as employees #FFDAC1 {
  + employee_id: Integer <<PK>>
  --
  employee_name: String
  position: String
  hire_date: Date
  # wash_id: Integer <<FK>>
}

entity "Рабочие боксы" as boxes #E2F0CB {
  + box_id: Integer <<PK>>
  --
  box_number: Integer
  box_type: String
  is_active: Boolean
  # wash_id: Integer <<FK>>
}

entity "Услуги" as services #B5EAD7 {
  + service_id: Integer <<PK>>
  --
  service_name: String
  price: Decimal
  duration_minutes: Integer
  description: String
  # wash_id: Integer <<FK>>
}

entity "Состав заказа" as order_items #C7CEEA {
  + item_id: Integer <<PK>>
  --
  quantity: Integer
  unit_price: Decimal
  # order_id: Integer <<FK>>
  # service_id: Integer <<FK>>
}

' === Основные отношения ===

customers ||--o{ cars : "владеет"
car_washes ||--o{ employees : "нанимает"
car_washes ||--o{ boxes : "содержит"
car_washes ||--o{ services : "предоставляет"

cities ||--o{ districts : "включает"
districts ||--o{ car_washes : "расположены"

' === Отношения заказов ===

orders }o--|| customers : "оформлен"
orders }o--|| cars : "для автомобиля"
orders }o--|| car_washes : "обслуживается"
orders }o--|| employees : "выполняется"
orders }o--|| boxes : "в боксе"

' === Дополнительные отношения ===

orders ||--o{ order_items : "содержит"
services ||--o{ order_items : "включается"

' === Отношения расположения ===

car_washes }o--|| cities : "в городе"
car_washes }o--|| districts : "в районе"

' === Стили и заметки ===

note top of customers #FFF9C4
  <b>Клиенты</b>
  Основная информация
  о клиентах системы
  с контактными данными
end note

note right of orders #E3F2FD
  <b>Статусы заказов:</b>
  • scheduled
  • in_progress
  • completed
  • cancelled
end note

note left of services #E8F5E8
  <b>Прайс-лист услуг</b>
  с указанием длительности
  выполнения и стоимости
end note

legend right
  <b>Обозначения</b>
  | PK - Первичный ключ |
  | FK - Внешний ключ |
  | ||--o{ : один-ко-многим |
  | }o--|| : многие-к-одному |
  <b>Цветовая схема:</b>
  | Клиенты | Автомобили |
  | Мойки | Заказы |
  | Справочники | Персонал |
end legend

@enduml
