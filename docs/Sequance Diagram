@startuml
actor "Пользователь" as User
participant "Веб-приложение" as WebApp
participant "REST API" as RestAPI
participant "СУБД" as Database
participant "Платежный шлюз" as PaymentGateway
participant "Система учета" as AccountingSystem

User -> WebApp: Выбирает услугу
WebApp -> RestAPI: Запрос списка услуг
RestAPI -> Database: Получить услуги
Database -> RestAPI: Список услуг
RestAPI -> WebApp: Передает услуги
WebApp -> User: Показывает услуги

User -> WebApp: Выбирает дату и время
WebApp -> RestAPI: Ищет свободные слоты
RestAPI -> Database: Проверить расписание
Database -> RestAPI: Свободные слоты
RestAPI -> WebApp: Список слотов 
WebApp -> User: Показывает слоты

User -> WebApp: Выбирает слот
WebApp -> RestAPI: Создать запись
RestAPI -> Database: Забронировать время
Database -> RestAPI: Подтверждение брони

RestAPI -> AccountingSystem: Создать документ заказа
AccountingSystem -> RestAPI: Номер документа
RestAPI -> WebApp: Подтверждение записи
WebApp -> User: "Записан! № заказа: XXX"

== ОПЛАТА ==

User -> WebApp: Оплачивает заказ
WebApp -> PaymentGateway: Процесс оплаты
PaymentGateway -> WebApp: Успех оплаты
WebApp -> RestAPI: Подтвердить оплату
RestAPI -> PaymentGateway: Проверить платеж
PaymentGateway -> RestAPI: Подтверждение

RestAPI -> AccountingSystem: Обновить статус оплаты
AccountingSystem -> RestAPI: Подтверждение
RestAPI -> WebApp: Оплата подтверждена
WebApp -> User: "Оплата прошла успешно!"

@enduml
